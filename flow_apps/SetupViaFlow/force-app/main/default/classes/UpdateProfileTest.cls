@isTest
public with sharing class UpdateProfileTest {
    
    @isTest
    public static void CanConvertDMCProfileToMetadataProfile() {

        flowDMC_Profile testProfile1 = Fixture_TestProfile_ApexType.testProfile1();
        usf3.MetadataService.Profile convertedProfile  = UpdateProfile.ConvertApexTypeToMetadataService_Profile(testProfile1);

        System.debug('serialized metadataservice Profile is:' + JSON.serialize(convertedProfile));
        String expectedSerializedMetadataType = '{"fullName":null,"userPermissions_type_info":["userPermissions","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"userPermissions":null,"userLicense_type_info":["userLicense","http://soap.sforce.com/2006/04/metadata",null,"0","1","false"],"userLicense":null,"type_att_info":["xsi:type"],"type":"Profile","tabVisibilities_type_info":["tabVisibilities","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"tabVisibilities":null,"recordTypeVisibilities_type_info":["recordTypeVisibilities","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"recordTypeVisibilities":[{"visible_type_info":["visible","http://soap.sforce.com/2006/04/metadata",null,"1","1","false"],"visible":true,"recordType_type_info":["recordType","http://soap.sforce.com/2006/04/metadata",null,"1","1","false"],"recordType":"Account.AccountRT1","personAccountDefault_type_info":["personAccountDefault","http://soap.sforce.com/2006/04/metadata",null,"0","1","false"],"personAccountDefault":false,"field_order_type_info":["default_x","personAccountDefault","recordType","visible"],"default_x_type_info":["default","http://soap.sforce.com/2006/04/metadata",null,"1","1","false"],"default_x":true,"apex_schema_type_info":["http://soap.sforce.com/2006/04/metadata","true","false"]},{"visible_type_info":["visible","http://soap.sforce.com/2006/04/metadata",null,"1","1","false"],"visible":false,"recordType_type_info":["recordType","http://soap.sforce.com/2006/04/metadata",null,"1","1","false"],"recordType":"Account.AccountRT2","personAccountDefault_type_info":["personAccountDefault","http://soap.sforce.com/2006/04/metadata",null,"0","1","false"],"personAccountDefault":false,"field_order_type_info":["default_x","personAccountDefault","recordType","visible"],"default_x_type_info":["default","http://soap.sforce.com/2006/04/metadata",null,"1","1","false"],"default_x":false,"apex_schema_type_info":["http://soap.sforce.com/2006/04/metadata","true","false"]},{"visible_type_info":["visible","http://soap.sforce.com/2006/04/metadata",null,"1","1","false"],"visible":true,"recordType_type_info":["recordType","http://soap.sforce.com/2006/04/metadata",null,"1","1","false"],"recordType":"Account.AccountRT3","personAccountDefault_type_info":["personAccountDefault","http://soap.sforce.com/2006/04/metadata",null,"0","1","false"],"personAccountDefault":false,"field_order_type_info":["default_x","personAccountDefault","recordType","visible"],"default_x_type_info":["default","http://soap.sforce.com/2006/04/metadata",null,"1","1","false"],"default_x":false,"apex_schema_type_info":["http://soap.sforce.com/2006/04/metadata","true","false"]}],"profileActionOverrides_type_info":["profileActionOverrides","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"profileActionOverrides":null,"pageAccesses_type_info":["pageAccesses","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"pageAccesses":null,"objectPermissions_type_info":["objectPermissions","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"objectPermissions":null,"loginIpRanges_type_info":["loginIpRanges","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"loginIpRanges":null,"loginHours_type_info":["loginHours","http://soap.sforce.com/2006/04/metadata",null,"0","1","false"],"loginHours":null,"layoutAssignments_type_info":["layoutAssignments","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"layoutAssignments":null,"fullName_type_info":["fullName","http://soap.sforce.com/2006/04/metadata",null,"0","1","false"],"fullName":null,"fieldPermissions_type_info":["fieldPermissions","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"fieldPermissions":null,"field_order_type_info":["fullName","applicationVisibilities","categoryGroupVisibilities","classAccesses","custom","customPermissions","description","externalDataSourceAccesses","fieldPermissions","layoutAssignments","loginHours","loginIpRanges","objectPermissions","pageAccesses","profileActionOverrides","recordTypeVisibilities","tabVisibilities","userLicense","userPermissions"],"externalDataSourceAccesses_type_info":["externalDataSourceAccesses","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"externalDataSourceAccesses":null,"description_type_info":["description","http://soap.sforce.com/2006/04/metadata",null,"0","1","false"],"description":null,"customPermissions_type_info":["customPermissions","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"customPermissions":null,"custom_type_info":["custom","http://soap.sforce.com/2006/04/metadata",null,"0","1","false"],"custom":null,"classAccesses_type_info":["classAccesses","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"classAccesses":null,"categoryGroupVisibilities_type_info":["categoryGroupVisibilities","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"categoryGroupVisibilities":null,"applicationVisibilities_type_info":["applicationVisibilities","http://soap.sforce.com/2006/04/metadata",null,"0","-1","false"],"applicationVisibilities":null,"apex_schema_type_info":["http://soap.sforce.com/2006/04/metadata","true","false"]}';



        System.assertEquals(expectedSerializedMetadataType, JSON.serialize(convertedProfile)); 

        

    }

}